@model EZRAC.Risk.UI.Web.ViewModels.Claims.DownloadContractInfoViewModel
@using EZRAC.Risk.UI.Web.Helper

<section class="panel panel-default complete-height bottom0">



    @using (Ajax.BeginForm("DownloadContractInfo", new { }, new AjaxOptions { OnSuccess = "UpdateSuccessful(data)", HttpMethod = "Post", OnFailure = "onErrorHandler(xhr)" }, new { @class = " bottom5  claim-info-form-editable", @id = "download-contract-info-form" }))
    {

        @Html.AntiForgeryToken()
        <header class="panel-heading">
            <h3 class="panel-title">
                Contract Information
                <span class="pull-right">

                    <a href="javascript:void(0);" onclick="$('#download-contract-info-form').submit();" class="inline-group save-icon-btn right10">
                        <span class="pull-right top3">DOWNLOAD</span>
                    </a>

                    @Ajax.MyActionLink("<span class='form-label'>CANCEL</span>", "ViewContractInfo", "display-inline  cancel-icon-btn top3", new { contractId = Model.ContractId, claimId=Model.ClaimId },
                                                       new AjaxOptions { UpdateTargetId = "contract-info", OnFailure = "onErrorHandler(xhr)" })

                </span>

            </h3>
        </header>

        <div class="top10 padding-horizontal-15">

            <div class="row bottom10">

                <div class="col-xs-4  top5 padding-right-0 ">
                    <label>@Html.DisplayNameFor(model => model.ContractNumber)</label>
                </div>
                <div class="col-xs-3 padding-left-0 ">
                    <div class="sandbox-container">

                        @Html.TextBoxFor(model => model.ContractNumber, Model.ContractNumber, new { @class = "form-control" })
                        @Html.ValidationMessageFor(model => model.ContractNumber)

                    </div>
                </div>
            </div>
          

        </div>

    <input id="view-claim" type="hidden" data-url="@Url.Action("ViewClaim", "Claims", new { id = Model.ClaimId })" />



        @Html.HiddenFor(model => model.ClaimId)
        @Html.HiddenFor(model => model.ContractId)
    }

</section>

<script type="text/javascript">

    function UpdateSuccessful(data) {
        if (data.indexOf("field-validation-error") > -1) {

            $("#contract-info").html(data);

        } else {
            
            window.location.href = $('#view-claim').data('url');

        }
    }

</script>